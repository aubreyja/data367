<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.26">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Exploring Some Ideas from Bill James</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js" integrity="sha384-ZvpUoO/+PpLXR1lu4jmpXWu80pZlYUAfxl5NsBMWOEPSjUn/6Z/hRTt8+pR6L4N2" crossorigin="anonymous"></script><script src="BaseballRunsPart1_files/libs/clipboard/clipboard.min.js"></script>
<script src="BaseballRunsPart1_files/libs/quarto-html/quarto.js" type="module"></script>
<script src="BaseballRunsPart1_files/libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="BaseballRunsPart1_files/libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="BaseballRunsPart1_files/libs/quarto-html/popper.min.js"></script>
<script src="BaseballRunsPart1_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="BaseballRunsPart1_files/libs/quarto-html/anchor.min.js"></script>
<link href="BaseballRunsPart1_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="BaseballRunsPart1_files/libs/quarto-html/quarto-syntax-highlighting-587c61ba64f3a5504c4d52d930310e48.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="BaseballRunsPart1_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="BaseballRunsPart1_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="BaseballRunsPart1_files/libs/bootstrap/bootstrap-2b4f361af69db28df83f62e4f62372d0.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script src="https://cdn.jsdelivr.net/npm/requirejs@2.3.6/require.min.js" integrity="sha384-c9c+LnTbwQ3aujuU7ULEPVvgLs+Fn6fJUvIGTsuu1ZcCf11fiEubah0ttpca4ntM sha384-6V1/AdqZRWk1KAlWbKBlGhN7VG4iE/yAZcO6NZPMF8od0vukrvr0tg4qY6NSrItx" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


</head>

<body class="fullcontent quarto-light">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Exploring Some Ideas from Bill James</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p><strong>Purpose</strong>: Each activity illustrates a little sports analytics, a little statistics, and a little python.</p>
<ul>
<li><p><strong>Sports Analytics:</strong> Try to explain how runs are scored in baseball — that is, to try to find a statistic that explains as much run scoring as possible.</p></li>
<li><p><strong>Statistics:</strong> Regression</p></li>
<li><p><strong>Python:</strong> Introduction to Python, including:</p>
<ul>
<li>reading a CSV</li>
<li>using a notebook</li>
<li>linear modeling</li>
<li>plotting</li>
</ul></li>
</ul>
<p><strong>Demonstration — Runs Scored and Homeruns</strong>: In this demonstration, we are going to examine the relationship between the number of homeruns hit and the number of runs scored.</p>
<p>Using function terms, we will consider homeruns as the independent variable and runs as the dependent variable. Using statistical terms, homeruns is called the <code>explanatory variable</code> and runs is the <code>response variable</code>.</p>
<p>It may seem arbitrary that we picked runs to be the response variable, but it is not. Ultimately, the goal of offense in baseball is to score as many runs as possible. We are trying to understand how runs are scored — or what statistic best explains how runs are scored — is it homeruns? batting average? stolen bases? or something else?</p>
<p>The data given in <code>BaseballRuns.csv</code> shows offensive statistics for MLB teams from 2000–2005.</p>
<p>Import the data into Python using:</p>
<div id="64dc7484" class="cell" data-execution_count="1">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># pandas is used for data manipulation</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd </span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co"># read data</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>bbr <span class="op">=</span> pd.read_csv(<span class="st">"data/BaseballRuns.csv"</span>) </span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The table of data is now in a data frame called <code>bbr</code>. (Think of a data frame as an array on steroids — where the entries of the array can be objects more complicated than just numbers or strings.)</p>
<p>We can get a summary of what is in this data frame:</p>
<div id="866fc2ce" class="cell" data-execution_count="2">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>bbr.describe()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="2">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th">G</th>
<th data-quarto-table-cell-role="th">Ghome</th>
<th data-quarto-table-cell-role="th">W</th>
<th data-quarto-table-cell-role="th">L</th>
<th data-quarto-table-cell-role="th">R</th>
<th data-quarto-table-cell-role="th">AB</th>
<th data-quarto-table-cell-role="th">H</th>
<th data-quarto-table-cell-role="th">1B</th>
<th data-quarto-table-cell-role="th">2B</th>
<th data-quarto-table-cell-role="th">3B</th>
<th data-quarto-table-cell-role="th">HR</th>
<th data-quarto-table-cell-role="th">BB</th>
<th data-quarto-table-cell-role="th">SO</th>
<th data-quarto-table-cell-role="th">SB</th>
<th data-quarto-table-cell-role="th">CS</th>
<th data-quarto-table-cell-role="th">HBP</th>
<th data-quarto-table-cell-role="th">SF</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">count</th>
<td>180.000000</td>
<td>180.000000</td>
<td>180.000000</td>
<td>180.000000</td>
<td>180.000000</td>
<td>180.000000</td>
<td>180.000000</td>
<td>180.000000</td>
<td>180.000000</td>
<td>180.000000</td>
<td>180.000000</td>
<td>180.000000</td>
<td>180.000000</td>
<td>180.000000</td>
<td>180.000000</td>
<td>180.000000</td>
<td>180.000000</td>
<td>180.000000</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">mean</th>
<td>2002.500000</td>
<td>161.922222</td>
<td>80.883333</td>
<td>80.933333</td>
<td>80.933333</td>
<td>773.650000</td>
<td>5552.950000</td>
<td>1472.038889</td>
<td>969.650000</td>
<td>294.577778</td>
<td>30.672222</td>
<td>177.138889</td>
<td>542.266667</td>
<td>1046.816667</td>
<td>91.683333</td>
<td>40.633333</td>
<td>59.455556</td>
<td>46.394444</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">std</th>
<td>1.712589</td>
<td>0.373053</td>
<td>0.609744</td>
<td>12.510822</td>
<td>12.512608</td>
<td>83.539137</td>
<td>80.080705</td>
<td>74.951110</td>
<td>56.970979</td>
<td>26.225272</td>
<td>8.288668</td>
<td>33.139246</td>
<td>74.503766</td>
<td>100.378305</td>
<td>30.086927</td>
<td>12.056154</td>
<td>12.781499</td>
<td>9.244353</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">min</th>
<td>2000.000000</td>
<td>161.000000</td>
<td>77.000000</td>
<td>43.000000</td>
<td>46.000000</td>
<td>574.000000</td>
<td>5330.000000</td>
<td>1300.000000</td>
<td>850.000000</td>
<td>201.000000</td>
<td>12.000000</td>
<td>116.000000</td>
<td>363.000000</td>
<td>805.000000</td>
<td>31.000000</td>
<td>12.000000</td>
<td>29.000000</td>
<td>25.000000</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">25%</th>
<td>2001.000000</td>
<td>162.000000</td>
<td>81.000000</td>
<td>71.000000</td>
<td>71.000000</td>
<td>714.000000</td>
<td>5496.750000</td>
<td>1422.500000</td>
<td>933.000000</td>
<td>277.750000</td>
<td>25.000000</td>
<td>152.000000</td>
<td>489.000000</td>
<td>984.250000</td>
<td>69.000000</td>
<td>32.750000</td>
<td>51.000000</td>
<td>40.000000</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">50%</th>
<td>2002.500000</td>
<td>162.000000</td>
<td>81.000000</td>
<td>82.000000</td>
<td>80.000000</td>
<td>768.000000</td>
<td>5545.000000</td>
<td>1470.000000</td>
<td>966.500000</td>
<td>293.000000</td>
<td>30.000000</td>
<td>173.500000</td>
<td>536.500000</td>
<td>1040.500000</td>
<td>88.500000</td>
<td>40.000000</td>
<td>58.000000</td>
<td>46.000000</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">75%</th>
<td>2004.000000</td>
<td>162.000000</td>
<td>81.000000</td>
<td>91.000000</td>
<td>91.000000</td>
<td>828.500000</td>
<td>5609.750000</td>
<td>1516.500000</td>
<td>1000.500000</td>
<td>310.250000</td>
<td>36.000000</td>
<td>200.000000</td>
<td>593.500000</td>
<td>1099.000000</td>
<td>109.250000</td>
<td>48.000000</td>
<td>67.000000</td>
<td>52.000000</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">max</th>
<td>2005.000000</td>
<td>163.000000</td>
<td>82.000000</td>
<td>116.000000</td>
<td>119.000000</td>
<td>978.000000</td>
<td>5769.000000</td>
<td>1667.000000</td>
<td>1186.000000</td>
<td>373.000000</td>
<td>61.000000</td>
<td>260.000000</td>
<td>775.000000</td>
<td>1399.000000</td>
<td>177.000000</td>
<td>74.000000</td>
<td>95.000000</td>
<td>75.000000</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<hr>
<section id="variables-in-the-dataset" class="level2">
<h2 class="anchored" data-anchor-id="variables-in-the-dataset">Variables in the Dataset</h2>
<ul>
<li><code>lg</code> — league (AL for American League, NL for National League)</li>
<li><code>team</code> — city of team (three-letter abbreviation)</li>
<li><code>G</code> — number of games played (162 is normal)</li>
<li><code>Ghome</code> — number of home games played (81 is normal)</li>
<li><code>W</code> — number of wins</li>
<li><code>L</code> — number of losses</li>
<li><code>R</code> — number of runs scored</li>
<li><code>AB</code> — number of at bats</li>
<li><code>X1B</code> — number of singles</li>
<li><code>X2B</code> — number of doubles</li>
<li><code>X3B</code> — number of triples</li>
<li><code>HR</code> — number of homeruns</li>
<li><code>BB</code> — number of walks</li>
<li><code>SO</code> — number of strikeouts</li>
<li><code>SB</code> — number of stolen bases</li>
<li><code>CS</code> — number of times caught stealing</li>
<li><code>HBP</code> — number of batters hit by pitch</li>
<li><code>SF</code> — number of sacrifice flies</li>
</ul>
<hr>
</section>
<section id="creating-and-plotting-a-linear-model" class="level2">
<h2 class="anchored" data-anchor-id="creating-and-plotting-a-linear-model">Creating and Plotting a Linear Model</h2>
<p>To plot <code>HR</code> versus <code>R</code>:</p>
<div id="98187332" class="cell" data-execution_count="3">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>plt.figure()</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>plt.scatter(bbr[<span class="st">"HR"</span>], bbr[<span class="st">"R"</span>])</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"Homeruns"</span>)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"Runs"</span>)</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Runs vs Homeruns"</span>)</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="BaseballRunsPart1_files/figure-html/cell-4-output-1.png" width="593" height="449" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>To create the “best-fitting line” for this data:</p>
<div id="21f22e31" class="cell" data-execution_count="4">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels.formula.api <span class="im">as</span> smf</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>g <span class="op">=</span> smf.ols(<span class="st">"R ~ HR"</span>, data<span class="op">=</span>bbr).fit()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>This stores the line — and much information about this line — in the variable <code>g</code>.</p>
<p>To see the intercept and slope of this line:</p>
<div id="a52866a3" class="cell" data-execution_count="5">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>g.params</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="5">
<pre><code>Intercept    452.358365
HR             1.813784
dtype: float64</code></pre>
</div>
</div>
<p>To add this line to the plot:</p>
<div id="3429093e" class="cell" data-execution_count="6">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>plt.figure()</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>plt.scatter(bbr[<span class="st">"HR"</span>], bbr[<span class="st">"R"</span>])</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"Homeruns"</span>)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"Runs"</span>)</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Runs vs Homeruns"</span>)</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Add regression line</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> bbr[<span class="st">"HR"</span>]</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>y_hat <span class="op">=</span> g.params[<span class="dv">0</span>] <span class="op">+</span> g.params[<span class="dv">1</span>] <span class="op">*</span> x</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>plt.plot(x, y_hat)</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>/var/folders/h8/21jh__4x2cg73mtl645922r40000gp/T/ipykernel_18169/3240435530.py:9: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  y_hat = g.params[0] + g.params[1] * x</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="BaseballRunsPart1_files/figure-html/cell-7-output-2.png" width="593" height="449" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<hr>
</section>
<section id="what-do-we-mean-by-best-fitting-line" class="level2">
<h2 class="anchored" data-anchor-id="what-do-we-mean-by-best-fitting-line">What Do We Mean by “Best-Fitting Line”?</h2>
<p>The equation for this best-fitting line is:</p>
<pre><code>R = 452.358 + 1.815 · HR</code></pre>
<p>We can use this equation (model) to predict how many runs a team scored based on how many homeruns they hit.</p>
<p>For example, the 2000 Anaheim Angels (ANA) hit 236 homeruns, so our model predicts they scored 880.698 runs. They actually scored 864 runs. The difference between the predicted number of runs and the actual number of runs is called a residual. In this case, the residual is 16.698.</p>
<p>We can use Python to calculate the predicted number of runs scored for each team:</p>
<div id="98aa58d8" class="cell" data-execution_count="7">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>Pred <span class="op">=</span> <span class="fl">452.358</span> <span class="op">+</span> <span class="fl">1.814</span> <span class="op">*</span> bbr[<span class="st">"HR"</span>]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>And the residual for each team:</p>
<div id="dae3dda6" class="cell" data-execution_count="8">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>Resid <span class="op">=</span> Pred <span class="op">-</span> bbr[<span class="st">"R"</span>]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>A “best-fitting” line should somehow minimize these residuals — and our line actually minimizes the sum of the squares of the residuals — which is why it is often called the least-squares line.</p>
<p>You can calculate the sum of the squares of the residuals:</p>
<div id="030edfc5" class="cell" data-execution_count="9">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="bu">sum</span>(Resid <span class="op">*</span> Resid)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="9">
<pre><code>602493.639948</code></pre>
</div>
</div>
<p>Now try a different line, such as:</p>
<pre><code>R = 410 + 2 · HR</code></pre>
<p>Then calculate the predicted values and residuals:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>Pred2 <span class="op">=</span> <span class="dv">410</span> <span class="op">+</span> <span class="fl">2.0</span> <span class="op">*</span> HR</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>Resid2 <span class="op">=</span> Pred2 <span class="op">-</span> R</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="bu">sum</span>(Resid2 <span class="op">*</span> Resid2)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>The sum of the squares for these residuals will be more than the sum of the squares of the residuals for our original model.</p>
<p>It is also called the regression line.</p>
<hr>
</section>
<section id="important-info-regarding-this-linear-model" class="level2">
<h2 class="anchored" data-anchor-id="important-info-regarding-this-linear-model">Important Info Regarding This Linear Model</h2>
<p>To get more details about our best-fitting line:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>summary(g)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>A couple of things to note in this summary:</p>
<ul>
<li><p>The <strong>R-squared value</strong> (shown as <code>Multiple R-squared</code>) is 0.5177. This means that 51.77% of the variation in runs can be explained by the number of homeruns.</p></li>
<li><p>The <strong>Residual standard error</strong> is 58.18. This gives us an idea of the size of the average residual — for our purposes, you can think of it as the standard deviation of the residuals.</p></li>
</ul>
<p>For example, we would expect about 95% of residuals to be within the interval:</p>
<pre><code>(−2 · 58.18, 2 · 58.18)</code></pre>
<hr>
</section>
<section id="group-activity" class="level2">
<h2 class="anchored" data-anchor-id="group-activity">Group Activity</h2>
<p>Consider the following statistics:</p>
<ul>
<li><p><strong>BA (batting average):</strong></p>
<pre><code>(1B + 2B + 3B + HR) / AB</code></pre></li>
<li><p><strong>SLG (slugging percentage):</strong></p>
<pre><code>(1B + 2·2B + 3·3B + 4·HR) / AB</code></pre></li>
<li><p><strong>OBP (on-base percentage):</strong></p>
<pre><code>(1B + 2B + 3B + HR + BB + HBP) /
(AB + BB + HBP + SF)</code></pre></li>
<li><p><strong>OPS (on-base plus slugging):</strong></p>
<pre><code>OPS = OBP + SLG</code></pre></li>
</ul>
<p>Determine the best-fit linear model for each of the following:</p>
<ul>
<li>runs versus batting average</li>
<li>runs versus slugging percentage</li>
<li>runs versus on-base percentage</li>
<li>runs versus on-base plus slugging percentage</li>
</ul>
<p>Be sure each model includes:</p>
<ul>
<li>the equation that predicts the number of runs scored</li>
<li>the R-squared value</li>
<li>the residual standard error</li>
</ul>
<p>Use Python to compute these new statistics. For example:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>bbr[<span class="st">"BA"</span>] <span class="op">=</span> (bbr[<span class="st">"1B"</span>] <span class="op">+</span> bbr[<span class="st">"2B"</span>] <span class="op">+</span> bbr[<span class="st">"3B"</span>] <span class="op">+</span> bbr[<span class="st">"HR"</span>]) <span class="op">/</span> bbr[<span class="st">"AB"</span>]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Now you can use the variable <code>BA</code> to compute your linear model.</p>
<p>Turn in your Python notebook in the appropriate assignment folder.</p>
<hr>
</section>
<section id="when-youre-done" class="level2">
<h2 class="anchored" data-anchor-id="when-youre-done">When You’re Done</h2>
<p>Consider the following questions:</p>
<ul>
<li><p>What variables can I make by combining these statistics to give a high R-squared value?</p></li>
<li><p>Download more recent data from baseballreference.com. Do the R-squared values for our statistics change dramatically?</p></li>
<li><p>What is the most predictive (based on R-squared) value that you can make with only 2 columns from your original data frame? What about 3 or 4?</p></li>
</ul>
<hr>
<p>These notes are adapted from Aaron Ekstrom and Abrielle Agron.</p>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>