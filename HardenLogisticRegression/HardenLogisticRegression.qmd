---
title: "Logistic Regression with James Harden"
author: Notes adapted from Jason Spector, Jericho Lawson, and Aaron Ekstrom
format:
  html: default
  pdf: default
fontsize: 11pt
---

## Overview
Having a game-changing player in the NBA can affect how successful his team is throughout the season. James Harden is no exception. While he was with the Rockets, he has made a name for himself through lots and lots of scoring (even if plenty of those points came from the free throw line). With that said, how well does James Harden need to do to ensure that the Rockets get a win? We will use logistic regression to answer this question. 

![](https://thespun.com/.image/ar_1:1,c_fill,cs_srgb,fl_progressive,q_auto:good,w_1200/MTgzMTI4NTIwODI1Nzc1NDU2/brooklyn-nets-v-houston-rockets.jpg){width=250}


## Logistic Regression Review

Logistic regression uses the machinery of linear regression, but adapts it for binary responses. The main limitation of linear regression is that the responses can be any real number. However, with binary responses, we are often interested in probabilities, which range between 0 and 1. 

The way we adapt linear regression for logistic regression is by applying a _logit_ transform. We model the _log-odds_ with linear regression:
$$
\log\left(\frac{p}{1-p}\right) = \hat{\beta_0} + \hat{\beta}_1 x.
$$
After some mathematical manipulation, we can rewrite it in terms of probability: 
$$
p = \frac{1}{1 + \exp\left(-\left(\hat{\beta}_0 + \hat{\beta}_1 x\right) \right)}
= \frac{\exp\left(\hat{\beta}_0 + \hat{\beta}_1 x \right)}{1 + \exp\left(\hat{\beta}_0 + \hat{\beta}_1 x \right)}.
$$



### Exploratory Data Analysis
In this demonstration, we are going to examine the relationship between the number of points scored by James Harden and whether the Rockets would win or lose. The data comes from 545 games played by James Harden and the Houston Rockets from October 31, 2012 to April 9, 2019.

```{python}
# Import Libraries
import pandas as pd
import numpy as np
import statsmodels.formula.api as smf
import matplotlib.pyplot as plt

# Load Data
harden = pd.read_csv("data/harden_revised.csv", index_col=0)
```

The first thing you should ever do when you get new data is to do some _exploratory data analysis_. You should orient yourself with what the data offers. What variables are considered? Does the data require additional data cleaning? 


```{python}
# Exploratory Data Analysis
harden.head()
```

**Numerical Encoding.** Today, we'll keep things simple and only look at the relationship between winning games (`Result`) and the number of points James Harden scored in the game (`PTS`). 

`Result` takes on character values of either `W` (win) or `L` (loss). Characters are harder to work with, so it customary to use a numerical encoding. In this dataset, we are provided that numerical encoding via the `Dummy` variable. It takes on a value of `0` for losses and `1` for wins. 

**Plotting Results**. Now that we've narrowed the scope of our problem to identifying the relationship between scoring and winning games, we're going to start by plotting the data. 

How valuable is James Harden to the Houston Rockets? As the figure shows below, the more points Harden scores, the more likely the Rockets are of winning games. However, aside from this surface-level observation, it's not clear just how much impact he has on the team.

```{python}
# Plot Points Scored by Harden vs. Wins
plt.figure()
plt.scatter(harden["PTS"], harden["Dummy"], alpha=0.2)
  # The alpha parameter sets the opacity of the points, making the density
  # of the points easier to see.
plt.xlabel("Points Scored")
plt.ylabel("Win (Win = 1, Loss = 0)")
plt.title("Rockets Wins based on Points Scored by James Harden")
plt.show()
```

## Logistic Regression


